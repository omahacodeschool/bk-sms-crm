
<script type="text/javascript" src="mike.js"></script>



<!-- ////////////////////////////////////////////////////////// -->
///////PICTURE THIS IN THE CENTER, WITH WORLD-CLASS CSS STYLING:///// 

//////////////////THIS IS THE CURRENT MESSAGE THREAD DIV://///////////

<div id="current_message_thread" class="center">

<%= @touches.where(client_id => @current_client.id). each do |x| %>
  <p>
    <%= x.message %>
  </p>
  <% if x.read == false %>
    <% x.read = true %>
  <% end %>
<% end %>


</div>
////////////////////////////END///////////////////////////////////////

//////////////THIS IS THE NEW MESSAGE DIV://///////////////////////////

<div id="new_message" class="center">

<!-- This is the current message -->


<!-- 
This is the post action for creating a new message.
  Required parts are: The client ID, business ID, the message content. The controller will set the OUTGOING boolean to "true", and the READ boolean to "true". The "form_tag" helper documentation can be found at:

  http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag 
  -->


<%= form_tag("/touch/create_new") do %>

<!-- Equal to the current user's ID. This Beta Version requires input to form. -->
<p> Client ID: 
<input type="integer" name="client_id" value="<%= params[:client_id] %>"></p>


<!-- Equal to the current user's ID. This Beta Version requires input to form. -->
<p>Business ID:
<input type="integer" name="business_id" value="<%= params[:business_id] %>"></p>


<!-- This is the text box for entering the message content.-->
<p>Message:
  <textarea name="message_content" rows="10" cols="75" value="<%= params[:message_content] %>">
  </textarea>
</p>

<p><input type="submit" value="Create"></p>

<% end %>

</div>

//////////////////////////////END//////////////////////////////

////////////THIS IS THE END OF THE CENTER SECTION.///////////////////
<!-- ////////////////////////////////////////////////////////////// -->


<!-- CLIENTS COLUMN -->
<div id="right" class="beth">

<!-- A NEW CLIENT-->
  <a href ="/clients/new">Add new client</a>

<!-- This is the dropdown menu of all clients -->
  <%= form_tag("/clients/view", class: "dropdown") do %>
  <select name="client_id">
        <option selected disabled>Choose client</option>
        <% @list_clients.each do |client| %>
          <option value= "<%= client.id %>"
          <%= "selected" if @client != nil && client.id == @client.id %>>
          <%=client.first_name %>
          <%=client.last_name %>
          </option>
        <%end%>
  </select>
    <input type="submit">
  <% end %>

<!-- This is the currently-selected client's info-->
<% if @client != nil %>
  <div id="client_info">
    <h2>Client info:</h2>
        <p id="client_name"><%= @client.first_name %> <%= @client.last_name %> </p>
      <h4> Client Number:</h4>
        <p id="client_number">
        (<%= @client.phone_number[0..2] %>)
        <%=@client.phone_number[3..5]%>-<%=@client.phone_number[6..9]%>
        </p>
      <h4> Client Notes:</h4>
        <p id="client_notes"><%= @client.notes %></p>
      <h4> Client Status: 
      <!-- This toggles the client's active/inactive status -->
      <a href ="/clients/<%= @client.id %>/update_status">Toggle Status</a>
      </h4>
        <p id="client_status">
          <% if @client.active == true %>
            Active
          <% else %>
            Inactive
            <% end %>
        </p>

<!-- This edits the current client-->
      <a href ="/clients/<%= @client.id %>/edit">Edit Client</a>
<!-- This creates a new message -->
<!--  ##need to add feature where client is automatically filled in -->
      <!-- <a href ="/touch/create_new/<%= @client.id %>">Send Client New Message</a> -->

  </div>
<% end %>
</div>

